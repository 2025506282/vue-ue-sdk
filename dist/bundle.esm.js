function e(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
e=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function d(e,t,n,o){var i=t&&t.prototype instanceof f?t:f,r=Object.create(i.prototype),a=new C(o||[]);return r._invoke=function(e,t,n){var o="suspendedStart";return function(i,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===i)throw r;return x()}for(n.method=i,n.arg=r;;){var a=n.delegate;if(a){var c=b(a,n);if(c){if(c===u)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var s=l(e,t,n);if("normal"===s.type){if(o=n.done?"completed":"suspendedYield",s.arg===u)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o="completed",n.method="throw",n.arg=s.arg)}}}(e,n,a),r}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var u={};function f(){}function g(){}function h(){}var p={};s(p,r,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(D([])));v&&v!==n&&o.call(v,r)&&(p=v);var y=h.prototype=f.prototype=Object.create(p);function w(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){var n;this._invoke=function(i,r){function a(){return new t((function(n,a){!function n(i,r,a,c){var s=l(e[i],e,r);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==typeof u&&o.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}(i,r,n,a)}))}return n=n?n.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var o=l(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,u;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function D(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return g.prototype=h,s(y,"constructor",h),s(h,"constructor",g),g.displayName=s(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},w(S.prototype),s(S.prototype,a,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,o,i,r){void 0===r&&(r=Promise);var a=new S(d(e,n,o,i),r);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(y),s(y,c,"Generator"),s(y,r,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var o=t.pop();if(o in e)return n.value=o,n.done=!1,n}return n.done=!0,n}},t.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,o){return a.type="throw",a.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var c=o.call(r,"catchLoc"),s=o.call(r,"finallyLoc");if(c&&s){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var i=o.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},t}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n,o,i,r,a){try{var c=e[r](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,i)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}function r(t){t=void 0!==t?t:{};var o=this,r=new URLSearchParams(window.location.search);this.cfg=void 0!==t.peerConnectionOptions?t.peerConnectionOptions:{},this.cfg.sdpSemantics="unified-plan",this.cfg.offerExtmapAllowMixed=!1,this.forceTURN=r.has("ForceTURN"),this.forceTURN&&(console.log("Forcing TURN usage by setting ICE Transport Policy in peer connection config."),this.cfg.iceTransportPolicy="relay"),this.cfg.bundlePolicy="balanced",this.forceMaxBundle=r.has("ForceMaxBundle"),this.forceMaxBundle&&(this.cfg.bundlePolicy="max-bundle"),this.pcClient=null,this.dcClient=null,this.tnClient=null,this.sdpConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1,voiceActivityDetection:!1},this.dataChannelOptions={ordered:!0},this.startVideoMuted=void 0!==t.startVideoMuted&&t.startVideoMuted,this.autoPlayAudio=void 0===t.autoPlayAudio||t.autoPlayAudio,this.useMic=r.has("useMic"),this.useMic||console.log("Microphone access is not enabled. Pass ?useMic in the url to enable it.");var a="localhost"===location.hostname||"127.0.0.1"===location.hostname,c="https:"===location.protocol;!this.useMic||a||c||(this.useMic=!1,console.error("Microphone access in the browser will not work if you are not on HTTPS or localhost. Disabling mic access."),console.error("For testing you can enable HTTP microphone access Chrome by visiting chrome://flags/ and enabling 'unsafely-treat-insecure-origin-as-secure'")),this.preferSFU=r.has("preferSFU"),console.log(this.preferSFU?"The browser will signal it would prefer an SFU connection. Remove ?preferSFU from the url to signal for P2P usage.":"The browser will signal for a P2P connection. Pass ?preferSFU in the url to signal for SFU usage."),this.latencyTestTimings={TestStartTimeMs:null,UEReceiptTimeMs:null,UEEncodeMs:null,UECaptureToSendMs:null,UETransmissionTimeMs:null,BrowserReceiptTimeMs:null,FrameDisplayDeltaTimeMs:null,Reset:function(){this.TestStartTimeMs=null,this.UEReceiptTimeMs=null,this.UEEncodeMs=null,this.UECaptureToSendMs=null,this.UETransmissionTimeMs=null,this.BrowserReceiptTimeMs=null,this.FrameDisplayDeltaTimeMs=null},SetUETimings:function(e){this.UEReceiptTimeMs=e.ReceiptTimeMs,this.UEEncodeMs=e.EncodeMs,this.UECaptureToSendMs=e.CaptureToSendMs,this.UETransmissionTimeMs=e.TransmissionTimeMs,this.BrowserReceiptTimeMs=Date.now(),this.OnAllLatencyTimingsReady(this)},SetFrameDisplayDeltaTime:function(e){null==this.FrameDisplayDeltaTimeMs&&(this.FrameDisplayDeltaTimeMs=Math.round(e),this.OnAllLatencyTimingsReady(this))},OnAllLatencyTimingsReady:function(e){}},this.createWebRtcVideo=function(){var e=document.getElementById("streamingVideo");if(e.muted="muted",e.addEventListener("loadedmetadata",(function(e){o.onVideoInitialised&&o.onVideoInitialised()}),!0),"requestVideoFrameCallback"in HTMLVideoElement.prototype){e.requestVideoFrameCallback((function t(n,i){if(i.receiveTime&&i.expectedDisplayTime){var r=i.presentationTime-i.receiveTime;o.aggregatedStats.receiveToCompositeMs=r}e.requestVideoFrameCallback(t)}))}return e},this.video=this.createWebRtcVideo(),this.availableVideoStreams=new Map;var s,d,l=function(e){console.info("Signaling state change. |",e.srcElement.signalingState,"|")},u=function(e){console.info("Browser ICE connection |",e.srcElement.iceConnectionState,"|")},f=function(e){console.info("Browser ICE gathering |",e.srcElement.iceGatheringState,"|")},g=function(e){if(e.track&&console.log("Got track. | Kind="+e.track.kind+" | Id="+e.track.id+" | readyState="+e.track.readyState+" |"),"audio"!=e.track.kind){e.track.kind;var t,n=i(e.streams);try{for(n.s();!(t=n.n()).done;){var r=t.value;o.availableVideoStreams.has(r.id)||o.availableVideoStreams.set(r.id,r)}}catch(e){n.e(e)}finally{n.f()}o.video.srcObject=e.streams[0],e.track.onunmute=function(){o.video.srcObject=e.streams[0],o.onNewVideoTrack(e.streams)}}else h(e.streams[0])},h=function(e){if(o.video.srcObject!=e&&o.video.srcObject&&o.video.srcObject!==e){var t=document.createElement("Audio");if(t.srcObject=e,o.autoPlayAudio)t.play();else{o.video.addEventListener("click",(function e(){t.play(),o.video.removeEventListener("click",e)}))}console.log("Created new audio element to play seperate audio stream.")}},p=function(e){console.log("Data channel created for us by browser as we are a receiving peer."),o.dcClient=e.channel,m(o.dcClient)},m=function(e){try{return e.binaryType="arraybuffer",e.onopen=function(e){console.log("Data channel connected"),o.onDataChannelConnected&&o.onDataChannelConnected()},e.onclose=function(e){console.log("Data channel connected",e)},e.onmessage=function(e){o.onDataChannelMessage&&o.onDataChannelMessage(e.data)},e.onerror=function(e){console.error("Data channel error",e)},e}catch(e){return console.warn("No data channel",e),null}},v=function(e){var t=e.candidate;t&&t.candidate&&(console.log("%c[Browser ICE candidate]","background: violet; color: black","| Type=",t.type,"| Protocol=",t.protocol,"| Address=",t.address,"| Port=",t.port,"|"),o.onWebRtcCandidate(t))},y=function(e){e.sdp=e.sdp.replace("useinbandfec=1","useinbandfec=1;stereo=1;sprop-maxcapturerate=48000")},w=function(e){e.onsignalingstatechange=l,e.oniceconnectionstatechange=u,e.onicegatheringstatechange=f,e.ontrack=g,e.onicecandidate=v,e.ondatachannel=p},S=(s=e().mark((function t(n){var r,a,c,s,d,l,u,f,g,h,p,m;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getTransceivers().length>0,n.addTransceiver("video",{direction:"recvonly"}),o.useMic){e.next=6;break}n.addTransceiver("audio",{direction:"recvonly"}),e.next=11;break;case 6:return a=!!o.useMic&&{autoGainControl:!1,channelCount:1,echoCancellation:!1,latency:0,noiseSuppression:!1,sampleRate:48e3,volume:1},e.next=9,navigator.mediaDevices.getUserMedia({video:!1,audio:a});case 9:if(c=e.sent)if(r){s=i(n.getTransceivers());try{for(s.s();!(d=s.n()).done;)if((l=d.value)&&l.receiver&&l.receiver.track&&"audio"===l.receiver.track.kind){u=i(c.getTracks());try{for(u.s();!(f=u.n()).done;)(g=f.value).kind&&"audio"==g.kind&&(l.sender.replaceTrack(g),l.direction="sendrecv")}catch(e){u.e(e)}finally{u.f()}}}catch(e){s.e(e)}finally{s.f()}}else{h=i(c.getTracks());try{for(h.s();!(p=h.n()).done;)(m=p.value).kind&&"audio"==m.kind&&n.addTransceiver(m,{direction:"sendrecv"})}catch(e){h.e(e)}finally{h.f()}}else n.addTransceiver("audio",{direction:"recvonly"});case 11:case"end":return e.stop()}}),t)})),d=function(){var e=this,t=arguments;return new Promise((function(o,i){var r=s.apply(e,t);function a(e){n(r,o,i,a,c,"next",e)}function c(e){n(r,o,i,a,c,"throw",e)}a(void 0)}))},function(e){return d.apply(this,arguments)});this.setVideoEnabled=function(e){o.video.srcObject.getTracks().forEach((function(t){return t.enabled=e}))},this.startLatencyTest=function(e){o.video&&(o.latencyTestTimings.Reset(),o.latencyTestTimings.TestStartTimeMs=Date.now(),e(o.latencyTestTimings.TestStartTimeMs))},this.handleCandidateFromServer=function(e){var t=new RTCIceCandidate(e);console.log("%c[Unreal ICE candidate]","background: pink; color: black","| Type=",t.type,"| Protocol=",t.protocol,"| Address=",t.address,"| Port=",t.port,"|"),o.forceTURN&&t.candidate.indexOf("relay")<0?console.warn("Dropping candidate because it was not TURN relay.","| Type=",t.type,"| Protocol=",t.protocol,"| Address=",t.address,"| Port=",t.port,"|"):o.pcClient.addIceCandidate(t).catch((function(e){console.error("Failed to add ICE candidate",e)}))},this.createOffer=function(){o.pcClient&&(console.log("Closing existing PeerConnection"),o.pcClient.close(),o.pcClient=null),o.pcClient=new RTCPeerConnection(o.cfg),w(o.pcClient),S(o.pcClient).finally((function(){var e,t,n,i;o.dcClient=(e=o.pcClient,t="cirrus",n=o.dataChannelOptions,i=e.createDataChannel(t,n),console.log("Created datachannel (".concat(t,")")),m(i),i),function(e){e.createOffer(o.sdpConstraints).then((function(t){y(t),e.setLocalDescription(t),o.onWebRtcOffer&&o.onWebRtcOffer(t)}),(function(){console.warn("Couldn't create offer")}))}(o.pcClient)}))},this.receiveOffer=function(e){var t=new RTCSessionDescription(e);o.pcClient||(console.log("Creating a new PeerConnection in the browser."),o.pcClient=new RTCPeerConnection(o.cfg),w(o.pcClient),o.pcClient.setRemoteDescription(t).then((function(){S(o.pcClient).finally((function(){o.pcClient.createAnswer().then((function(e){return o.pcClient.setLocalDescription(e)})).then((function(){o.onWebRtcAnswer&&o.onWebRtcAnswer(o.pcClient.currentLocalDescription)})).then((function(){var e,t=i(o.pcClient.getReceivers());try{for(t.s();!(e=t.n()).done;){e.value.playoutDelayHint=0}}catch(e){t.e(e)}finally{t.f()}})).catch((function(e){return console.error("createAnswer() failed:",e)}))}))})))},this.receiveAnswer=function(e){var t=new RTCSessionDescription(e);o.pcClient.setRemoteDescription(t);var n,r=i(o.pcClient.getReceivers());try{for(r.s();!(n=r.n()).done;){n.value.playoutDelayHint=0}}catch(e){r.e(e)}finally{r.f()}},this.close=function(){o.pcClient&&(console.log("Closing existing peerClient"),o.pcClient.close(),o.pcClient=null),o.aggregateStatsIntervalId&&clearInterval(o.aggregateStatsIntervalId)},this.send=function(e){o.dcClient&&"open"==o.dcClient.readyState&&o.dcClient.send(e)},this.getStats=function(e){o.pcClient&&e&&o.pcClient.getStats(null).then((function(t){e(t)}))},this.aggregateStats=function(e){var t=(o.aggregatedStats||(o.aggregatedStats={}),function(e){var t={};e.forEach((function(e){"inbound-rtp"!=e.type||e.isRemote||"video"!=e.mediaType&&!e.id.toLowerCase().includes("video")||(t.timestamp=e.timestamp,t.bytesReceived=e.bytesReceived,t.framesDecoded=e.framesDecoded,t.packetsLost=e.packetsLost,t.bytesReceivedStart=o.aggregatedStats&&o.aggregatedStats.bytesReceivedStart?o.aggregatedStats.bytesReceivedStart:e.bytesReceived,t.framesDecodedStart=o.aggregatedStats&&o.aggregatedStats.framesDecodedStart?o.aggregatedStats.framesDecodedStart:e.framesDecoded,t.timestampStart=o.aggregatedStats&&o.aggregatedStats.timestampStart?o.aggregatedStats.timestampStart:e.timestamp,o.aggregatedStats&&o.aggregatedStats.timestamp&&(o.aggregatedStats.bytesReceived&&(t.bitrate=8*(t.bytesReceived-o.aggregatedStats.bytesReceived)/(t.timestamp-o.aggregatedStats.timestamp),t.bitrate=Math.floor(t.bitrate),t.lowBitrate=o.aggregatedStats.lowBitrate&&o.aggregatedStats.lowBitrate<t.bitrate?o.aggregatedStats.lowBitrate:t.bitrate,t.highBitrate=o.aggregatedStats.highBitrate&&o.aggregatedStats.highBitrate>t.bitrate?o.aggregatedStats.highBitrate:t.bitrate),o.aggregatedStats.bytesReceivedStart&&(t.avgBitrate=8*(t.bytesReceived-o.aggregatedStats.bytesReceivedStart)/(t.timestamp-o.aggregatedStats.timestampStart),t.avgBitrate=Math.floor(t.avgBitrate)),o.aggregatedStats.framesDecoded&&(t.framerate=(t.framesDecoded-o.aggregatedStats.framesDecoded)/((t.timestamp-o.aggregatedStats.timestamp)/1e3),t.framerate=Math.floor(t.framerate),t.lowFramerate=o.aggregatedStats.lowFramerate&&o.aggregatedStats.lowFramerate<t.framerate?o.aggregatedStats.lowFramerate:t.framerate,t.highFramerate=o.aggregatedStats.highFramerate&&o.aggregatedStats.highFramerate>t.framerate?o.aggregatedStats.highFramerate:t.framerate),o.aggregatedStats.framesDecodedStart&&(t.avgframerate=(t.framesDecoded-o.aggregatedStats.framesDecodedStart)/((t.timestamp-o.aggregatedStats.timestampStart)/1e3),t.avgframerate=Math.floor(t.avgframerate)))),"track"!=e.type||"video_label"!=e.trackIdentifier&&"video"!=e.kind||(t.framesDropped=e.framesDropped,t.framesReceived=e.framesReceived,t.framesDroppedPercentage=e.framesDropped/e.framesReceived*100,t.frameHeight=e.frameHeight,t.frameWidth=e.frameWidth,t.frameHeightStart=o.aggregatedStats&&o.aggregatedStats.frameHeightStart?o.aggregatedStats.frameHeightStart:e.frameHeight,t.frameWidthStart=o.aggregatedStats&&o.aggregatedStats.frameWidthStart?o.aggregatedStats.frameWidthStart:e.frameWidth),"candidate-pair"==e.type&&e.hasOwnProperty("currentRoundTripTime")&&0!=e.currentRoundTripTime&&(t.currentRoundTripTime=e.currentRoundTripTime)})),o.aggregatedStats.receiveToCompositeMs&&(t.receiveToCompositeMs=o.aggregatedStats.receiveToCompositeMs,o.latencyTestTimings.SetFrameDisplayDeltaTime(o.aggregatedStats.receiveToCompositeMs)),o.aggregatedStats=t,o.onAggregatedStats&&o.onAggregatedStats(t)});o.aggregateStatsIntervalId=setInterval((function(){o.getStats(t)}),e)}}var a="GamepadEvent"in window,c="WebKitGamepadEvent"in window,s={},d=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.requestAnimationFrame;document.createEvent("KeyboardEvent").initKeyboardEvent;var l,u,f,g=null,h=(new Date).getTime(),p=new Map,m=null,v=!0,y={receiving:!1,size:0,jpeg:void 0,height:0,width:0,valid:!1},w={mimetype:"",extension:"",receiving:!1,size:0,data:[],valid:!1,timestampStart:void 0},S=void 0,b=void 0;function T(){for(j in function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],t=0;t<e.length;t++)e[t]&&e[t].index in s&&(s[e[t].index].currentState=e[t])}(),s){for(var e=s[j],t=e.currentState,n=e.prevState,o=0;o<t.buttons.length;o++){var i=t.buttons[o],r=n.buttons[o];i.pressed&&!r.pressed?6==o?D(j,5,i.value):7==o?D(j,6,i.value):E(j,o,0):!i.pressed&&r.pressed?6==o?D(j,5,0):7==o?D(j,6,0):C(j,o):i.pressed&&r.pressed&&(6==o?D(j,5,i.value):7==o?D(j,6,i.value):E(j,o,1))}for(var a=0;a<t.axes.length;a+=2){var c=parseFloat(t.axes[a].toFixed(4)),l=-parseFloat(t.axes[a+1].toFixed(4));0===a?(D(j,1,c),D(j,2,l)):2===a&&(D(j,3,c),D(j,4,l))}s[j].prevState=t}d(T)}function E(e,t,n){Data=new DataView(new ArrayBuffer(4)),Data.setUint8(0,ce.GamepadButtonPressed),Data.setUint8(1,e),Data.setUint8(2,t),Data.setUint8(3,n)}function C(e,t){Data=new DataView(new ArrayBuffer(3)),Data.setUint8(0,ce.GamepadButtonReleased),Data.setUint8(1,e),Data.setUint8(2,t)}function D(e,t,n){Data=new DataView(new ArrayBuffer(11)),Data.setUint8(0,ce.GamepadAnalog),Data.setUint8(1,e),Data.setUint8(2,t),Data.setFloat64(3,n,!0),O(Data.buffer)}function x(e){console.log("Gamepad connect handler"),gamepad=e.gamepad,s[gamepad.index]={},s[gamepad.index].currentState=gamepad,s[gamepad.index].prevState=gamepad,console.log("gamepad: "+gamepad.id+" connected"),d(T)}function R(e){console.log("Gamepad disconnect handler"),console.log("gamepad: "+e.gamepad.id+" disconnected"),delete s[e.gamepad.index]}function k(e,t,n){var o=document.getElementById("videoPlayOverlay");if(!o){var i=document.getElementById("player");(o=document.createElement("div")).id="videoPlayOverlay",i.appendChild(o)}for(;o.lastChild;)o.removeChild(o.lastChild);t&&o.appendChild(t),n&&o.addEventListener("click",(function e(t){n(t),o.removeEventListener("click",e)}));for(var r=o.classList,a=r.length-1;a>=0;a--)r.remove(r[a]);o.classList.add(e)}function M(){setTimeout((function(){!function(){if(window.WebSocket=window.WebSocket||window.MozWebSocket,!window.WebSocket)return void alert("Your browser doesn't support WebSocket");(l=new WebSocket("ws://"+Pe)).onmessage=function(e){var n,o,i=JSON.parse(e.data);"config"===i.type?(console.log("%c[Inbound SS (config)]","background: lightblue; color: black",i),function(e){var n=function(e,n){g=new r(n),e.appendChild(g.video),e.appendChild(m),g.onWebRtcOffer=function(e){if(l&&1===l.readyState){var t=JSON.stringify(e);console.log("%c[Outbound SS message (offer)]","background: lightgreen; color: black",e),l.send(t)}},g.onWebRtcCandidate=function(e){l&&1===l.readyState&&l.send(JSON.stringify({type:"iceCandidate",candidate:e}))},g.onWebRtcAnswer=function(e){if(l&&1===l.readyState){var t=JSON.stringify(e);console.log("%c[Outbound SS message (answer)]","background: lightgreen; color: black",e),l.send(t)}},g.onVideoInitialised=function(){l&&1===l.readyState&&(v?(I(),oe()):(oe(),U()))},g.onDataChannelConnected=function(){f&&f(),l&&1===l.readyState&&L("WebRTC data channel connected... waiting for video")},g.onNewVideoTrack=function(e){g.video&&g.video.srcObject&&g.onVideoInitialised&&g.onVideoInitialised()},g.onDataChannelMessage=function(e){var n=new Uint8Array(e);if(n[0]===F)!function(e){console.log(t(e)),console.log("recv:",e);var n=JSON.parse(e);if("event"!==n.command)return void console.log("unexpected response:",e);var o=n.func_name,i=p.get(o);i&&i(n.args)}(new TextDecoder("utf-16").decode(e.slice(1)));else if(n[0]===P){var o=new TextDecoder("utf-16").decode(e.slice(1));console.log(o);var i=JSON.parse(o);"onScreenKeyboard"===i.command&&function(e){if(e.showOnScreenKeyboard){S.classList.remove("hiddenState");var t=ue(e.x,e.y);S.style.top=t.y.toString()+"px",S.style.left=(t.x-40).toString()+"px"}else S.classList.add("hiddenState"),b.blur()}(i)}else if(n[0]===H)!function(e){y.receiving||(y.receiving=!0,y.valid=!1,y.size=0,y.jpeg=void 0);y.size=new DataView(e.slice(1,5).buffer).getInt32(0,!0);var t=e.slice(5);if(y.jpeg){var n=new Uint8Array(y.jpeg.length+t.length);n.set(y.jpeg,0),n.set(t,y.jpeg.length),y.jpeg=n}else y.jpeg=t,y.receiving=!0,console.log("received first chunk of freeze frame: ".concat(y.jpeg.length,"/").concat(y.size));y.jpeg.length===y.size?(y.receiving=!1,y.valid=!0,console.log("received complete freeze frame ".concat(y.size)),o=btoa(y.jpeg.reduce((function(e,t){return e+String.fromCharCode(t)}),"")),(i=document.getElementById("freezeFrameOverlay").childNodes[0]).src="data:image/jpeg;base64,"+o,i.onload=function(){y.height=i.naturalHeight,y.width=i.naturalWidth,ne(),v?(I(),oe()):ee(),g.setVideoEnabled(!1)}):y.jpeg.length>y.size&&(console.error("received bigger freeze frame than advertised: ".concat(y.jpeg.length,"/").concat(y.size)),y.jpeg=void 0,y.receiving=!1);var o,i}(n);else if(n[0]===N)te();else if(n[0]===V)new TextDecoder("utf-16").decode(e.slice(1));else if(n[0]==G){var r=new TextDecoder("utf-16").decode(e.slice(1));console.log("Got latency timings from UE."),console.log(r);var a=JSON.parse(r);g&&g.latencyTestTimings.SetUETimings(a)}else n[0]==z?function(e){w.receiving||(w.mimetype="",w.extension="",w.receiving=!0,w.valid=!1,w.size=0,w.data=[],w.timestampStart=(new Date).getTime(),console.log("Received first chunk of file"));var t=new TextDecoder("utf-16").decode(e.slice(1));console.log(t),w.extension=t}(n):n[0]==Y?function(e){w.receiving||(w.mimetype="",w.extension="",w.receiving=!0,w.valid=!1,w.size=0,w.data=[],w.timestampStart=(new Date).getTime(),console.log("Received first chunk of file"));var t=new TextDecoder("utf-16").decode(e.slice(1));console.log(t),w.mimetype=t}(n):n[0]==q?function(e){if(!w.receiving)return;w.size=Math.ceil(new DataView(e.slice(1,5).buffer).getInt32(0,!0)/16379);var t=e.slice(5);if(w.data.push(t),console.log("Received file chunk: ".concat(w.data.length,"/").concat(w.size)),w.data.length===w.size){w.receiving=!1,w.valid=!0,console.log("Received complete file");var n=(new Date).getTime()-w.timestampStart,o=Math.round(16*w.size*1024/n);console.log("Average transfer bitrate: ".concat(o,"kb/s over ").concat(n/1e3," seconds"));var i=new Blob(w.data,{type:w.mimetype}),r=document.createElement("a");r.setAttribute("href",URL.createObjectURL(i)),r.setAttribute("download","transfer.".concat(w.extension));var a=$(r);a.appendTo("body"),a.remove()}else w.data.length>w.size&&(w.receiving=!1,console.error("Received bigger file than advertised: ".concat(w.data.length,"/").concat(w.size)))}(n):console.error("unrecognized data received, packet ID ".concat(n[0]))},function(e){if(!e)return;(function(e){e.onmouseenter=function(t){var n=new DataView(new ArrayBuffer(1));n.setUint8(0,ce.MouseEnter),O(n.buffer),e.pressMouseButtons(t)},e.onmouseleave=function(t){var n=new DataView(new ArrayBuffer(1));n.setUint8(0,ce.MouseLeave),O(n.buffer),e.releaseMouseButtons(t)}})(e),function(e){var t=[9,8,7,6,5,4,3,2,1,0],n={};function o(t,o){var i=new DataView(new ArrayBuffer(2+7*o.length));i.setUint8(0,t),i.setUint8(1,o.length);for(var r=2,a=0;a<o.length;a++){var c=o[a],s=c.clientX-e.offsetLeft,d=c.clientY-e.offsetTop,l=de(s,d);i.setUint16(r,l.x,!0),r+=2,i.setUint16(r,l.y,!0),r+=2,i.setUint8(r,n[c.identifier],!0),r+=1,i.setUint8(r,255*c.force,!0),r+=1,i.setUint8(r,l.inRange?1:0,!0),r+=1}O(i.buffer)}e.ontouchstart=function(e){for(var i=0;i<e.changedTouches.length;i++)r=e.changedTouches[i],a=void 0,void 0===(a=t.pop())&&console.log("exhausted touch indentifiers"),n[r.identifier]=a;var r,a;o(ce.TouchStart,e.changedTouches),e.preventDefault()},e.ontouchend=function(e){o(ce.TouchEnd,e.changedTouches);for(var i=0;i<e.changedTouches.length;i++)r=e.changedTouches[i],t.push(n[r.identifier]),delete n[r.identifier];var r;e.preventDefault()},e.ontouchmove=function(e){o(ce.TouchMove,e.touches),e.preventDefault()}}(e)}(g.video),"ontouchstart"in document.documentElement&&function(e){null===document.getElementById("hiddenInput")&&((b=document.createElement("input")).id="hiddenInput",b.maxLength=0,e.appendChild(b));null===document.getElementById("editTextButton")&&((S=document.createElement("button")).id="editTextButton",S.innerHTML="edit text",e.appendChild(S),S.classList.add("hiddenState"),S.addEventListener("click",(function(){b.focus()})))}(e);return g.video}(document.getElementById("player"),e);switch(oe(),Z.controlScheme){case Q:!function(e){e.onmousemove=function(e){fe(e.offsetX,e.offsetY,e.movementX,e.movementY),e.preventDefault()},e.onmousedown=function(e){ge(e.button,e.offsetX,e.offsetY),e.preventDefault()},e.onmouseup=function(e){he(e.button,e.offsetX,e.offsetY),e.preventDefault()},e.oncontextmenu=function(e){he(e.button,e.offsetX,e.offsetY),e.preventDefault()},"onmousewheel"in e?e.onmousewheel=function(e){pe(e.wheelDelta,e.offsetX,e.offsetY),e.preventDefault()}:e.addEventListener("DOMMouseScroll",(function(e){pe(-120*e.detail,e.offsetX,e.offsetY),e.preventDefault()}),!1);e.pressMouseButtons=function(e){Re(e.buttons,e.offsetX,e.offsetY)},e.releaseMouseButtons=function(e){xe(e.buttons,e.offsetX,e.offsetY)}}(n);break;case J:ke(n);break;default:console.log("ERROR: Unknown control scheme ".concat(Z.controlScheme)),ke(n)}}(i)):"playerCount"===i.type?console.log("%c[Inbound SS (playerCount)]","background: lightblue; color: black",i):"offer"===i.type?(console.log("%c[Inbound SS (offer)]","background: lightblue; color: black",i),o=i,g.receiveOffer(o),K()):"answer"===i.type?(console.log("%c[Inbound SS (answer)]","background: lightblue; color: black",i),function(e){g.receiveAnswer(e),K()}(i)):"iceCandidate"===i.type?(n=i.candidate,g&&g.handleCandidateFromServer(n)):"warning"===i.type&&i.warning?console.warn(i.warning):console.error("Invalid SS message type",i.type)},l.onerror=function(e){console.log("WS error: ".concat(JSON.stringify(e)))},l.onclose=function(e){console.log("WS closed: ".concat(JSON.stringify(e.code)," - ").concat(e.reason)),l=void 0;var t=document.getElementById("player");g&&(t.removeChild(g.video),g.close(),g=void 0),L("Disconnected: ".concat(e.reason)),setTimeout(Fe,4e3)}}()}),300)}function L(e){var t=document.createElement("div");t.id="messageOverlay",t.innerHTML=e||"",k("textDisplayState",t)}function U(){g&&g.video?(g.video.play().catch((function(e){console.error(e),console.log("Browser does not support autoplaying video without interaction - to resolve this we are going to show the play button overlay."),I()})),O(new Uint8Array([ce.RequestInitialSettings]).buffer),O(new Uint8Array([ce.RequestQualityControl]).buffer),ee(),k("hiddenState")):console.error("Could not player video stream because webRtcPlayerObj.video was not valid.")}function I(){setTimeout((function(){g&&U()}),500)}function O(e){g&&g.send(e)}var A,B,W,_,F=1,P=2,H=3,N=4,V=5,G=6,z=8,Y=9,q=10;function K(){g.onAggregatedStats=function(e){e.timestamp,e.timestampStart},g.aggregateStats(1e3)}var X,J=0,Q=1,Z={controlScheme:Q,suppressBrowserKeys:!0,fakeMouseWithTouches:!1};function ee(){y.valid&&(m.classList.add("freezeframeBackground"),m.style.display="block")}function te(){m.style.display="none",y.valid=!1,m.classList.remove("freezeframeBackground"),g&&g.setVideoEnabled(!0)}function ne(){if(0!==y.width&&0!==y.height){var e=0,t=0,n=0,o=0,i=document.getElementById("enlarge-display-to-fill-window-tgl"),r=document.getElementById("player");if(null!==i&&i.checked){var a=window.innerWidth/window.innerHeight,c=y.width/y.height;a<c?(e=window.innerWidth,t=Math.floor(window.innerWidth/c),n=Math.floor(.5*(window.innerHeight-t)),o=0):(e=Math.floor(window.innerHeight*c),t=window.innerHeight,n=0,o=Math.floor(.5*(window.innerWidth-e)))}else{var s=r.offsetWidth/r.offsetHeight,d=y.width/y.height;s<d?(e=r.offsetWidth,t=Math.floor(r.offsetWidth/d),n=Math.floor(.5*(r.offsetHeight-t)),o=0):(e=Math.floor(r.offsetHeight*d),t=r.offsetHeight,n=0,o=Math.floor(.5*(r.offsetWidth-e)))}var l=document.getElementById("freezeFrameOverlay").childNodes[0];m.style.width=r.offsetWidth+"px",m.style.height=r.offsetHeight+"px",m.style.left="0px",m.style.top="0px",l.style.width=e+"px",l.style.height=t+"px",l.style.left=o+"px",l.style.top=n+"px"}}function oe(e){var t=document.getElementById("player");if(t)if(re(),t.classList.contains("fixed-size"))ie(t);else{var n=document.getElementById("enlarge-display-to-fill-window-tgl"),o=window.innerWidth<t.videoWidth||window.innerHeight<t.videoHeight;null!==n?n.checked||o?function(e){var t=e.getElementsByTagName("VIDEO"),n=window.innerHeight/window.innerWidth,o=e.clientHeight/e.clientWidth,i=t.videoHeight/t.videoWidth;isNaN(i)?(A=window.innerWidth,B=window.innerHeight,W=0,_=0,e.style="top: "+W+"px; left: "+_+"px; width: "+A+"px; height: "+B+"px; cursor: default; "+void 0):n<o?(A=Math.floor(window.innerHeight/i),B=window.innerHeight,W=0,_=Math.floor(.5*(window.innerWidth-A)),e.style="top: "+W+"px; left: "+_+"px; width: "+A+"px; height: "+B+"px; cursor: default; "+void 0):(A=window.innerWidth,B=Math.floor(window.innerWidth*i),W=Math.floor(.5*(window.innerHeight-B)),_=0,e.style="top: "+W+"px; left: "+_+"px; width: "+A+"px; height: "+B+"px; cursor: default; "+void 0)}(t):function(e){var t=e.getElementsByTagName("VIDEO");if(t.length>0){A=t[0].videoWidth,B=t[0].videoHeight;var n=Math.floor(.5*(window.innerHeight-B)),o=Math.floor(.5*(window.innerWidth-A));W=n>0?n:0,_=o>0?o:0,e.style="top: "+W+"px; left: "+_+"px; width: "+A+"px; height: "+B+"px; cursor: default; "+void 0}}(t):function(e){e.getElementsByTagName("VIDEO"),e.style="top: 0px; left: 0px; width: "+A+"px; height: "+B+"px; cursor: default; "+void 0}(t),ie(t)}}function ie(e){e.getBoundingClientRect(),function(){var e=document.getElementById("player"),t=e.getElementsByTagName("video");if(e&&t.length>0){var n=e.clientHeight/e.clientWidth,o=t[0].videoHeight/t[0].videoWidth;if(n>o){var i=n/o;de=function(t,n){var o=t/e.clientWidth,r=i*(n/e.clientHeight-.5)+.5;return o<0||o>1||r<0||r>1?{inRange:!1,x:65535,y:65535}:{inRange:!0,x:65536*o,y:65536*r}},ue=function(t,n){var o=(n/65536-.5)/i+.5;return{x:t/65536*e.clientWidth,y:o*e.clientHeight}},le=function(t,n){return{x:32767*(t/(.5*e.clientWidth)),y:32767*(i*n/(.5*e.clientHeight))}}}else{var r=o/n;de=function(t,n){var o=r*(t/e.clientWidth-.5)+.5,i=n/e.clientHeight;return o<0||o>1||i<0||i>1?{inRange:!1,x:65535,y:65535}:{inRange:!0,x:65536*o,y:65536*i}},ue=function(t,n){var o=n/65536;return{x:((t/65536-.5)/r+.5)*e.clientWidth,y:o*e.clientHeight}},le=function(t,n){return{x:32767*(r*t/(.5*e.clientWidth)),y:32767*(n/(.5*e.clientHeight))}}}}}(),ne()}function re(){if((new Date).getTime()-h>1e3){var e=document.getElementById("player");if(!e)return;var t={ConsoleCommand:"setres "+e.clientWidth+"x"+e.clientHeight};!function(e){se(ce.Command,e)}(t),console.log(t),h=(new Date).getTime()}else console.log("Resizing too often - skipping"),clearTimeout(u),u=setTimeout(re,1e3)}function ae(e){clearTimeout(X),X=setTimeout((function(){oe()}),500)}var ce={IFrameRequest:0,RequestQualityControl:1,FpsRequest:2,AverageBitrateRequest:3,StartStreaming:4,StopStreaming:5,LatencyTest:6,RequestInitialSettings:7,UIInteraction:50,Command:51,KeyDown:60,KeyUp:61,KeyPress:62,MouseEnter:70,MouseLeave:71,MouseDown:72,MouseUp:73,MouseMove:74,MouseWheel:75,TouchStart:80,TouchEnd:81,TouchMove:82,GamepadButtonPressed:90,GamepadButtonReleased:91,GamepadAnalog:92};function se(e,t){var n=JSON.stringify(t),o=new DataView(new ArrayBuffer(3+2*n.length)),i=0;o.setUint8(i,e),i++,o.setUint16(i,n.length,!0),i+=2;for(var r=0;r<n.length;r++)o.setUint16(i,n.charCodeAt(r),!0),i+=2;O(o.buffer)}var de=void 0,le=void 0,ue=void 0;function fe(e,t,n,o){var i=de(e,t),r=le(n,o),a=new DataView(new ArrayBuffer(9));a.setUint8(0,ce.MouseMove),a.setUint16(1,i.x,!0),a.setUint16(3,i.y,!0),a.setInt16(5,r.x,!0),a.setInt16(7,r.y,!0),O(a.buffer)}function ge(e,t,n){var o=de(t,n),i=new DataView(new ArrayBuffer(6));i.setUint8(0,ce.MouseDown),i.setUint8(1,e),i.setUint16(2,o.x,!0),i.setUint16(4,o.y,!0),O(i.buffer)}function he(e,t,n){var o=de(t,n),i=new DataView(new ArrayBuffer(6));i.setUint8(0,ce.MouseUp),i.setUint8(1,e),i.setUint16(2,o.x,!0),i.setUint16(4,o.y,!0),O(i.buffer)}function pe(e,t,n){var o=de(t,n),i=new DataView(new ArrayBuffer(7));i.setUint8(0,ce.MouseWheel),i.setInt16(1,e,!0),i.setUint16(3,o.x,!0),i.setUint16(5,o.y,!0),O(i.buffer)}var me=0,ve=1,ye=2,we=3,Se=4,be=1,Te=2,Ee=4,Ce=8,De=16;function xe(e,t,n){e&be&&he(me,t,n),e&Te&&he(ye,t,n),e&Ee&&he(ve,t,n),e&Ce&&he(we,t,n),e&De&&he(Se,t,n)}function Re(e,t,n){e&be&&ge(me,t,n),e&Te&&ge(ye,t,n),e&Ee&&ge(ve,t,n),e&Ce&&ge(we,t,n),e&De&&ge(Se,t,n)}function ke(e){var t=e.width/2,n=e.height/2;function o(){document.pointerLockElement===e||document.mozPointerLockElement===e?(console.log("Pointer locked"),document.addEventListener("mousemove",i,!1)):(console.log("The pointer lock status is now unlocked"),document.removeEventListener("mousemove",i,!1))}function i(e){t+=e.movementX,n+=e.movementY,t>A&&(t-=A),n>B&&(n-=B),t<0&&(t=A+t),n<0&&(n=B-n),fe(t,n,e.movementX,e.movementY)}e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,e.onclick=function(){e.requestPointerLock()},document.addEventListener("pointerlockchange",o,!1),document.addEventListener("mozpointerlockchange",o,!1),e.onmousedown=function(e){ge(e.button,t,n)},e.onmouseup=function(e){he(e.button,t,n)},e.onmousewheel=function(e){pe(e.wheelDelta,t,n)},e.pressMouseButtons=function(e){Re(e.buttons,t,n)},e.releaseMouseButtons=function(e){xe(e.buttons,t,n)}}function Me(e){return e>=112&&e<=123||9===e}var Le=8,Ue=16,Ie=17,Oe=18,Ae=253,Be=254,We=255;function _e(e){return e.keyCode===Ue&&"ShiftRight"===e.code?Ae:e.keyCode===Ie&&"ControlRight"===e.code?Be:e.keyCode===Oe&&"AltRight"===e.code?We:e.keyCode}function Fe(){M(),te(),v=!0,oe()}var Pe="localhost:80";function je(){window.addEventListener("resize",oe,!0),window.addEventListener("orientationchange",ae),a?(window.addEventListener("gamepadconnected",x),window.addEventListener("gamepaddisconnected",R)):c&&(window.addEventListener("webkitgamepadconnected",x),window.addEventListener("webkitgamepaddisconnected",R)),function(){(m=document.createElement("div")).id="freezeFrameOverlay",m.style.display="none",m.style.pointerEvents="none",m.style.position="absolute",m.style.zIndex="20";var e=document.createElement("img");e.style.position="absolute",m.appendChild(e)}(),document.onkeydown=function(e){O(new Uint8Array([ce.KeyDown,_e(e),e.repeat]).buffer),e.keyCode===Le&&document.onkeypress({charCode:Le}),Me(e.keyCode)&&e.preventDefault()},document.onkeyup=function(e){O(new Uint8Array([ce.KeyUp,_e(e)]).buffer),Me(e.keyCode)&&e.preventDefault()},document.onkeypress=function(e){var t=new DataView(new ArrayBuffer(3));t.setUint8(0,ce.KeyPress),t.setUint16(1,e.charCode,!0),O(t.buffer)},Fe()}function He(e,t,n){var o,i={command:"event",func_name:e,args:t};console.log("send:",i),p.set(e,n),o=i,se(ce.UIInteraction,o)}function Ne(e,t){p.set(e,t)}function Ve(e){p.delete(e)}function Ge(e,t){console.log("ws to signal server: ",e),Pe=e,f=t,je()}function ze(e,t){var n,o,i,r;(n={path:e,method:"get"},o=n.path,i=n.method,r=n.data,new Promise((function(e,t){var n=new XMLHttpRequest;n.open(i,o),n.send(r),n.onreadystatechange=function(){4===n.readyState&&(n.status>=200&&n.status<300?e.call(void 0,JSON.parse(n.responseText)):n.status>=400&&t.call(void 0,n))}}))).then((function(e){e&&e.data&&Ge(e.data,t)}))}function Ye(e,t,n,o,i,r,a,c,s,d){"boolean"!=typeof a&&(s=c,c=a,a=!1);const l="function"==typeof n?n.options:n;let u;if(e&&e.render&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,i&&(l.functional=!0)),o&&(l._scopeId=o),r?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(r)},l._ssrRegister=u):t&&(u=a?function(e){t.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,c(e))}),u)if(l.functional){const e=l.render;l.render=function(t,n){return u.call(n),e(t,n)}}else{const e=l.beforeCreate;l.beforeCreate=e?[].concat(e,u):[u]}return n}f=null;var qe=function(){this.$createElement;return this._self._c,this._m(0)};qe._withStripped=!0;var Ke=Ye({render:qe,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"playerUI"}},[t("div",{attrs:{id:"player"}}),this._v(" "),t("video",{staticStyle:{width:"100%",height:"100%",position:"absolute","object-fit":"fill"},attrs:{id:"streamingVideo",playsinline:""}})])}]},void 0,{},"data-v-e46786b4",!1,void 0,!1,void 0,void 0,void 0),Xe={CHANE_RISK_CHART:"changeRiskChart",CHANE_MONITOR_CHART:"changeMonitorChart",GO_TO_WATER_DETAIL:"goToWaterDetail",GO_TO_FIRE_DETAIL:"goToFireDetail",SWITCH_FIRE:"switchFire",SWITCH_WATER:"switchWater",CHANGE_3D_SCENE:"change3DScene",MARK_SYMBOL:"markSymbol",ON_ENTER_3D_SCENE:"Enter3DSecene"},Je={FIRE:"fire",WATER:"water",TECHNOLOGY:"technology",TECHNOLOGY_DETAIL:"technologyDetail",TECHNOLOGY_DETAIL_FIRE:"technologyDetailFire",TECHNOLOGY_DETAIL_WATER:"technologyDetailWater"},$e={DEFAULT:"default",GAS:"gas",HEAT:"heat",BRIDGE:"bridge",PIPE:"pipe",WATER_SUPPLY:"waterSupply",DRAIN:"drain",SUBWAY_TUNNEL:"subwayTunnel",ELEVATOR:"elevator",FIRE_CONTROL:"fireControl"};export{$e as MARK_TYPE,Xe as METHOD_TYPE,Je as SCENE_TYPE,Ke as UEPlayer,Ne as api_register,He as api_send,Ve as api_unregister,Ge as app_load,ze as app_load2};
